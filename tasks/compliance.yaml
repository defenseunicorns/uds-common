# Copyright 2024 Defense Unicorns
# SPDX-License-Identifier: AGPL-3.0-or-later OR LicenseRef-Defense-Unicorns-Commercial

variables:
  - name: SKIP_OSCAL
    default: "true"

tasks:
  - name: validate
    description: Lula Validate OSCAL Compliance
    inputs:
      oscalfile:
        description: OSCAL File to Validate
        default: ./oscal-component.yaml
      assessment_results:
        description: Path for the output Assessment Results from Validate
        default: ./oscal-assessment-results.yaml
      options:
        description: For setting additional flags
    actions:
      - cmd: |
          echo "⚠️ WARNING: oscal linting has been deprecated and will be removed in a future release."
          lula validate -f ${{ .inputs.oscalfile }} -o ${{ .inputs.assessment_results }} ${{ .inputs.options }}
        if: ${{ eq .variables.SKIP_OSCAL "false" }}

  - name: evaluate
    description: Lula Evaluate multiple OSCAL Assessment Results
    inputs:
      assessment_results:
        description: File path to the single Assessment Results file that contains the array of Assessment Results
        default: ./oscal-assessment-results.yaml
      options:
        description: For setting additional flags
    actions:
      - cmd: |
          echo "⚠️ WARNING: oscal linting has been deprecated and will be removed in a future release."
          lula evaluate -f ${{ .inputs.assessment_results }} ${{ .inputs.options }}
        if: ${{ eq .variables.SKIP_OSCAL "false" }}